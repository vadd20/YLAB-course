# lesson4

**1. Movie Database.**

Скачать файл https://perso.telecom-paristech.fr/eagan/class/igr204/data/film.csv

В файле содержатcя данные о фильмах

Необходимо

- Реализовать код, читающий данные из файла и записывающий в таблицу через
JDBC. Для добавления данных использовать PreparedStatement.

Данные, считываемые из файла должны быть упакованы в экземпляр
указанного класса. Затем этот экземпляр должен передаваться коду, который
будет отвечать за сохранение данных в БД

Обратить внимание, что в файле могут некоторые значения могут
отсутствовать. В таком случает надо вызывать preparedStatement.setNull(<index>, java.sql.Types.<тип>)

Создание таблицы уже добавлено в проект, реализацию необходимо добавить в
класс io.ylab.intensive.lesson04_PostgreSQL_and_RabbitMQ.movie.MovieLoaderImpl
- Для созданной таблицы написать запрос, выводящий количество фильмов
каждого жанра (GROUP BY). Запрос написать в комментариях к коду решения.

**2. Persistent Map**
Необходимо реализовать Map, хранящий свое состояние исключительно в базе
данных. То есть, любое изменение данных Map (добавление и удаление), а также
получение данных должно транслироваться в соответствующие SQL запросы. Данные
необходимо хранить в таблице.

**3. FileSort Returns!**

Реализовать интерфейс FileSorter

Реализация интерфейса получает на вход файл, состоящий из чисел (long),
разделенных переносом строки и возвращает файл, в котором эти числа
отсортированы в порядке убывания.

- Можно считать, что максимальный размер файла - 1000000 чисел
- Сортировку необходимо реализовать средствами БД
- Работа с БД - средствами JDBC
- При вставке данных обязательно использовать batch-processing. Разобраться
что это такое, для чего используется и как реализовать

**4. Event Sourcing (hard)**

Написать 2 приложения, реализующие функционал асинхронной записи данных в БД.

Приложение оперирует классом Person, содержащий данные о людях.

Задача состоит из написание двух приложения, одно из которых содержит реализацию
интерфейса взаимодействия с системой, второе - для взаимодействия с БД

Приложение DataProcessor. Принимает из RabbitMQ сообщения о добавлении/удалении данных, затем выполняет
в БД соответствующие запросы. Необходимо, чтобы сообщения, отправленные первыми, обрабатывались также
первыми (чтобы принцип FIFO не нарушался).

Приложение API.
Приложение содержит реализацию интерфейса PersonApi
- deletePerson генерирует сообщение-команду на удаление персоны с заданным
id. Далее это сообщение должно быть обработано соответствующим запросом,
выполняя удаление данных. Если данных для определенного personId не
найдено - выводить в лог сообщение, что была попытка удаления, но при этом
данные не найдены. Exception или другую ошибку не выдавать
- savePerson генерирует сообщение-команду на сохранение данных персоны.
Обработчик должен проверить, существует ли в БД персона с переданным
personId. Если существует - необходимо выполнить обновление данных
(обновить три поля firstName, lastName, middleName). Если не существует -
создать персону с переданным personId.
- findPerson. Генерирует запрос напрямую в БД и возвращает данные персоны,
если персона для данного personId найдена, null в противном случае
- findAll. Генерирует запрос напрямую в БД и возвращает данные о ВСЕХ
сохраненных в базе персонах
